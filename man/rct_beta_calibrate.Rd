% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rct_beta_calibrate.R
\name{rct_beta_calibrate}
\alias{rct_beta_calibrate}
\title{Run a full Bayesian NI analysis (Beta–Binomial, conjugate)}
\usage{
rct_beta_calibrate(
  alpha = 0.1,
  p_c = 0.85,
  p_t = 0.85,
  n_c = 29,
  n_t = 29,
  NI_margin = -0.2,
  prior = c("flat", "jeffreys", "power"),
  prior_args = list(),
  B_cal = 2000,
  B_power = 1000,
  n_draws = 2000,
  tol = 0.002,
  seed = 123,
  show_progress = FALSE,
  verbose = TRUE,
  method = c("cpp", "simulate")
)
}
\arguments{
\item{alpha}{Target Type-I error rate (numeric in \verb{(0,1)}).}

\item{p_c, p_t}{True response probabilities in control and treatment (numeric in \verb{[0,1]}).}

\item{n_c, n_t}{Sample sizes in control and treatment arms (integers).}

\item{NI_margin}{Non-inferiority margin on the risk-difference scale (numeric).}

\item{prior}{Character. Specifies the prior distribution. Options:
\itemize{
\item \code{"flat"}: Flat Beta(1,1) prior for both arms (non-informative),
\item \code{"jeffreys"}: Jeffreys prior, i.e., Beta(0.5, 0.5) for both arms,
\item \code{"power"}: Power prior on the control arm, requires specification in \code{prior_args}.
}}

\item{prior_args}{List of additional prior hyperparameters. Required when \code{prior = "power"}:
\itemize{
\item \code{a0}: Discount factor for historical control data (numeric in \verb{[0,1]}),
\item \code{y_0}, \code{n_0}: Historical control responders and total sample size (integers),
\item \code{a_base}, \code{b_base}: Baseline Beta parameters (default is \code{1}, \code{1}).
Ignored when \code{prior} is \code{"flat"} or \code{"jeffreys"}.
}}

\item{B_cal}{Number of simulated trials for calibration of \code{gamma}.}

\item{B_power}{Number of simulated trials for power estimation.}

\item{n_draws}{Posterior Monte Carlo draws per trial for evaluating \code{Pr(NI)}.}

\item{tol}{Absolute tolerance for calibration convergence.}

\item{seed}{RNG seed for reproducibility.}

\item{show_progress}{Logical. Show text progress bars during simulation.}

\item{verbose}{Logical. Print iteration messages during calibration.}

\item{method}{Character. Method for estimation. Either \code{"simulate"} or \code{"cpp"}.}
}
\value{
An object of class \code{"bayesNI"} with components:
\itemize{
\item \code{calibration}: list from \code{\link[=bcts_calibrate_betaBinom_conj]{bcts_calibrate_betaBinom_conj()}}
\item \code{power}: estimated Bayesian power at calibrated \code{gamma}
\item \code{settings}: list of all input parameters (echoed)
}
}
\description{
Calibrates the posterior cutoff \eqn{\gamma} to control Type-I error at a target
\code{alpha}, and then estimates the corresponding Bayesian power for given trial
parameters. Uses conjugate Beta–Binomial updates (no MCMC).
}
\examples{
\donttest{
res <- rct_beta_calibrate(
  alpha = 0.10, p_c = .85, p_t = .85,
  n_c = 29, n_t = 29, NI_margin = -0.20,
  prior = "flat", B_cal = 1000, B_power = 500,
  method = "cpp"
)
res$calibration$gamma
res$power
}

}
\seealso{
\code{\link[=bcts_calibrate_betaBinom_conj]{bcts_calibrate_betaBinom_conj()}},
\code{\link[=rct_beta_power]{rct_beta_power()}},
\code{\link[=bcts_type1_betaBinom_conj]{bcts_type1_betaBinom_conj()}}
}
\concept{conjugate-NI}
