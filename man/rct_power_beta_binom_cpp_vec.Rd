% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{rct_power_beta_binom_cpp_vec}
\alias{rct_power_beta_binom_cpp_vec}
\title{Estimate Power for Bayesian RCT Using Beta-Binomial Conjugate Model (C++)}
\usage{
rct_power_beta_binom_cpp_vec(
  B,
  p_c,
  p_t,
  n_c,
  n_t,
  M,
  threshold,
  prior,
  prior_args,
  n_draws,
  show_progress = TRUE
)
}
\arguments{
\item{B}{Integer. Number of simulated trials.}

\item{p_c, p_t}{Numeric in [0, 1]. True response probabilities in the control and treatment arms.}

\item{n_c, n_t}{Integers. Sample sizes in the control and treatment arms.}

\item{M}{Numeric. Margin on the risk-difference scale:
\itemize{
\item Negative for non-inferiority,
\item Zero for equivalence,
\item Positive for superiority.
}}

\item{threshold}{Numeric in (0, 1). Posterior probability threshold \eqn{\gamma}.}

\item{prior}{Character. Type of prior to use:
\itemize{
\item \code{"flat"}: independent Beta priors for both arms,
\item \code{"power"}: power prior on the control arm, flat prior on treatment.
}}

\item{prior_args}{List of prior hyperparameters. The following elements are supported:
\itemize{
\item \code{a0}: Discount factor for historical control data (only used if \code{prior = "power"}).
\item \code{y_0}, \code{n_0}: Number of responses and total patients in the historical control data.
\item \code{a_base_c}, \code{b_base_c}: Shape parameters of the Beta prior for the control arm.
\item \code{a_base_t}, \code{b_base_t}: Shape parameters of the Beta prior for the treatment arm.
\itemize{
\item Defaults for all \verb{a_base_*} and \verb{b_base_*} values are 1 (i.e., flat prior).
}
}}

\item{n_draws}{Integer. Number of posterior draws per trial for estimating the probability.}

\item{show_progress}{Logical. Show progress bar in the console.}
}
\value{
A logical vector of length \code{B}, indicating for each trial whether the decision
criterion was met (i.e., trial declared successful).
}
\description{
Performs Monte Carlo simulation to estimate the statistical power of a
Bayesian randomized controlled trial (RCT) using conjugate Beta-Binomial
models for the control and treatment arms. The function supports flat priors
and power priors on the control arm, and allows for fully customizable
baseline Beta prior parameters for both arms.
}
\details{
A trial is declared successful if the posterior probability
\eqn{Pr(\theta_t - \theta_c > M \mid \text{data}) \ge \gamma}.

This function uses Rcpp and vectorized binomial simulation to increase speed.
Posterior samples are drawn from Beta distributions parameterized using either flat priors
or power priors (for control) combined with observed trial data.
}
\examples{
prior_args <- list(
  a0 = 0.5, y_0 = 20, n_0 = 30,
  a_base_c = 1, b_base_c = 1,
  a_base_t = 2, b_base_t = 2
)
decisions <- rct_power_beta_binom_cpp_vec(
  B = 1000, p_c = 0.8, p_t = 0.8,
  n_c = 25, n_t = 25,
  M = -0.1, threshold = 0.9,
  prior = "power", prior_args = prior_args,
  n_draws = 2000, show_progress = FALSE
)
mean(decisions)  # Estimated power

}
